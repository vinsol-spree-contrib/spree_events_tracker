SpreeEventsTracker
==================

Spree Events Tracker is a spree extension used to track various user activities. This extension can be used to track
  1. Keywords searched by User
  2. Products detail page and other pages visited by User
  3. Product added/removed/updated to cart
  4. Checkout flow during completion of an order

Data Archival Functionality
---------------------------
Activity tracking continuously updates the data.  

Generating reports from the continuously updated data can severely downgrade the performance.    

So, we periodically archive the data, and generate reports from the archived data, thereby, improving the overall performance.  

For archiving the data, we copy the data from primary tables to secondary tables, and delete the record from primary tables.

We have disabled the functionality of data archiving initially.  
You need to run a rake task to enable data archiving.

```ruby
bundle exec rake spree_events_tracker:set_archival_choice
```

You need to run a rake task to archive data.

```ruby
bundle exec rake spree_events_tracker:archive_data
```

You can run this rake task inside a cron job to periodically archive data.

```ruby
Using whenever gem
-------------------

every 1.hour do
  rake 'spree_events_tracker:archive_data'
end
```

> Since the data is archived periodically, it may lag behind the live data.

Note
------
It is advised not to stop archiving once you start archiving the data.   

If you stop archiving the data, it will create erroneous reports, since the data is partially archived, and you will be creating reports based on live data.  

If you need to stop archiving, please de - archive ( move data from secondary tables to primary tables ) to generate correct reports.   

Demo
----
Try Spree Events Tracker with archival Functionality for Spree master with direct deployment on Heroku:

[![Deploy](https://www.herokucdn.com/deploy/button.svg)](https://heroku.com/deploy?template=https://github.com/vinsol-spree-contrib/spree-demo-heroku/tree/spree-events-tracker-data-archival)


Installation
------------

1. Add this extension to your Gemfile:

  #### Spree >= 3.2

  ```ruby
  gem 'spree_events_tracker', github: 'vinsol-spree-contrib/spree_events_tracker', branch: 'master'
  ```

  #### Spree < 3.2

  ```ruby
  gem 'spree_events_tracker', github: 'vinsol-spree-contrib/spree_events_tracker', branch: 'X-X-stable'
  ```

  The `branch` option is important: it must match the version of Spree you're using.
  For example, use `3-0-stable` if you're using Spree `3-0-stable` or any `3.0.x` version.

2. Install the gem using Bundler:
  ```ruby
  bundle install
  ```

3. Copy & run migrations
  ```ruby
  bundle exec rails g spree_events_tracker:install
  ```

4. Restart your server

  If your server was running, restart it so that it can find the assets properly.

Testing
-------

  #### Spree >= 3.1

  For Building Dependencies:
  ```shell
  appraisal install
  ```

  The dummy app can be regenerated by using:
  ```shell
  appraisal spree-3-1 rake test_app

  ```
  This will run rake test_app using the dependencies configured for Spree 3.1. Similarly you can use spree-3-2 and spree-master for generating dummy applications using dependencies for Spree 3.2 and latest version of Spree


  ```shell
  appraisal spree-3-1 rspec
  ```
  This will run rspec using the dependencies configured for Spree 3.1. Similarly you can use spree-3-2 and spree-master to run rspec using dependencies for Spree 3.2 and latest version of Spree


  #### Spree 3.0 and Spree 2.x

  First bundle your dependencies, then run `rake`. `rake` will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using `rake test_app`.

  ```shell
  bundle
  bundle exec rspec spec
  ```

Contributing
------------

  1. Fork the repository.
  2. Clone your repository.
  3. Run `bundle install`.
  5. Make the required changes.
  6. Ensure all specs are passing.
  7. Submit your pull request.

Credits
-------

[![vinsol.com: Ruby on Rails, iOS and Android developers](http://vinsol.com/vin_logo.png "Ruby on Rails, iOS and Android developers")](http://vinsol.com)

Copyright (c) 2017 [vinsol.com](http://vinsol.com "Ruby on Rails, iOS and Android developers"), released under the New MIT License
